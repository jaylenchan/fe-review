# 模板方法模式

## 概述

开发时碰到的问题：设计系统时知道总体的步骤，而且能够确定这些步骤的执行顺序，但是其中某些步骤是跟具体的环境相关的，没办法立马确定下来具体实现代码的。

例如，去银行办理业务一般要经过四个步骤：取号，排队，办理业务，对工作人员评分。其中，取号，排队，对工作人员评分是完全一样的具体步骤，而办理业务对于每一个人来说具体的内容都是不一样的。对于这样的场景，可以把完全一样的具体步骤放在父类中实现，而具体内容不同的步骤延迟到子类去实现。这就是通过类继承的方式去控制流程。

模板方法模式：定义一个操作中的算法骨架，而将算法的一些步骤延迟到子类中实现，使得子类可以在不改变算法结构的情况下，重新定义算法中某些步骤的具体实现。

一般有两部分组成，第一部分是抽象父类，第二部分是具体的实现子类。

好莱坞原则，子类放弃了控制权，改由父类来调用。

- 发布订阅
- 回调函数

模板方法模式强调算法流程固定不变，定义一条线（算法流程），线上的多个点是可以变化的（具体实现在子类中完成），线上的多个点一定是会被执行的，并且一定是按照特定流程被执行的。

## 特点

- 算法流程执行顺序确定
- 算法某些步骤具体实现不确定
- 父类中确定算法执行顺序，调用算法流程，子类负责重写算法流程当中某些步骤的具体实现

## 结构

模板方法模式包含以下角色：

- 抽象类：负责给出一个算法的具体骨架，它由一个模板方法+多个基本方法组成
  - 模板方法：定义算法骨架，按照某种顺序调用抽象类中包含的基本方法
  - 基本方法：抽象类中作为算法某个步骤的方法，是模板方法的组成部分，分成三类：
    - 抽象方法：在抽象类中声明，在具体子类中实现
    - 具体方法：在抽象类中声明并实现，在具体子类中可以重写
    - 钩子方法：在抽象类中声明并实现，包括两种类型：用来判断的逻辑方法和需要子类重写的空方法。钩子方法一般出现的方式是第一种：用来判断的逻辑方法，这类方法名一般时`isXXX`，返回值时`boolean`

- 具体子类：用来实现抽象类中所定义的抽象方法和钩子方法

## 优缺点

- ### 优点

  - 提高代码复用性
    - 算法的总体步骤执行是放在父类当中的，子类不需要重写或者重新实现。即模板方法
    - 算法中完全一致的步骤是放在父类当中的，即基本方法中的具体方法，子类只需要对抽象方法进行实现

  - 实现了反向控制：以前都是通过子类调用父类的方法，现在可以通过父类反过来调用子类的方法，通过对每个子类的具体实现不同来达到改变具体的算法流程内容，实现反向控制，符合“开闭原则”

- ### 缺点
  
  - 不同的实现需要不同的子类，会导致类数量增加，系统会越来越庞大
  - 父类中的抽象方法放到了子类实现，而由父类控制算法流程，形成了反向控制的结构，会导致代码难以阅读

## 适用场景

- 如果一个算法的整体流程步骤是完全确定的，执行顺序是确定好的，但是其中个别步骤是容易改变的。这个时候就可以使用模板方法模式，将容易变的步骤抽象出来，放到具体子类实现。
- 如果需要通过子类去决定父类算法当中的某些步骤是否执行，想要通过子类对父类进行控制（反向控制），这个时候就可以使用模板方法模式，将容易变的步骤抽象出来，放到具体子类实现。（钩子函数的使用场景 - 生命周期）

## 前端场景
